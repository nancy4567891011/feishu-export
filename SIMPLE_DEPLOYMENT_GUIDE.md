# 飞书多维表格导出工具 - 简化部署指南 🚀

> 基于您的实际情况，我们采用网页应用的方式，这是最简单有效的部署方案

## 🎯 部署方式确认

**✅ 推荐：网页应用方式**
- 简单直接，无需复杂配置
- 可以直接访问多维表格数据
- 部署快速，测试方便

**❌ 不推荐：云文档小组件**
- 需要上传程序包到开发者工具
- 配置复杂，学习成本高
- 适合更复杂的场景

## 📋 当前任务清单

### ✅ 已完成
- [x] 创建应用"多维表格导出工具"
- [x] 添加网页应用能力
- [x] 项目代码开发完成
- [x] 生产版本构建成功

### 🔄 待完成
- [ ] 配置网页应用入口URL
- [ ] 获取App ID和App Secret
- [ ] 更新本地配置文件
- [ ] 在飞书中测试功能

## 🛠️ 具体操作步骤

### 第一步：配置网页应用
1. **在飞书开发者后台，进入"网页应用"页面**
2. **在"桌面端主页"输入框填入**：
   ```
   http://localhost:3000
   ```
3. **选择打开方式**：**在飞书内新窗页打开**
4. **点击保存**

### 第二步：获取应用凭证
1. **点击左侧菜单"凭证与基础信息"**
2. **复制以下信息**：
   ```
   App ID: cli_xxxxxxxxxx
   App Secret: xxxxxxxxxxxx
   ```

### 第三步：更新本地配置
编辑项目中的 `src/config.ts` 文件：
```typescript
export const config = {
  isDevelopment: false,  // 改为false
  feishu: {
    appId: 'cli_您的App ID',
    appSecret: '您的App Secret',
  }
};
```

### 第四步：切换到生产模式
```bash
# 切换API调用方式
node switch-mode.js prod

# 重启开发服务器
npm run dev
```

### 第五步：在飞书中测试
1. **打开飞书桌面版或网页版**
2. **进入任意多维表格**
3. **查找应用入口**（通常在右上角的应用菜单中）
4. **点击"多维表格导出工具"**
5. **测试数据读取和导出功能**

## 🔧 应用权限配置

确保在"权限管理"中开通以下权限：
```
✅ 多维表格相关权限：
  - bitable:app          # 应用权限
  - bitable:record       # 记录读取
  - bitable:field        # 字段信息

✅ 文档相关权限：
  - drive:drive          # 云文档访问
  - docx:write           # 文档写入

✅ 基础权限：
  - contact:user.base    # 用户基本信息
```

## 🎉 成功标志

配置成功后，您应该能够：
1. **在飞书中找到您的应用**
2. **点击后在飞书内打开插件界面**
3. **看到真实的多维表格字段和数据**
4. **成功导出文档和下载附件**

## ⚠️ 常见问题

### 问题1：找不到应用入口
- 确认应用状态为"已启用"
- 检查权限是否正确配置
- 确认URL配置正确

### 问题2：无法读取数据
- 检查App ID和Secret是否正确
- 确认权限范围包含多维表格相关权限
- 查看浏览器控制台错误信息

### 问题3：导出功能异常
- 确认本地服务器运行正常
- 检查网络连接
- 查看具体错误提示

## 📞 下一步

完成上述配置后：
1. **您的插件就可以在飞书中正常使用了**
2. **可以导出真实的多维表格数据**
3. **支持批量下载附件到本地**

如果遇到问题，请提供具体的错误信息，我会帮您排查解决！ 