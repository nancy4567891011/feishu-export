# 飞书多维表格导出功能使用指南

## 📋 功能概述

本插件可以将飞书多维表格的数据按照特定规则导出为文档和附件，实现结构化的文件组织。

## 🎯 导出规则

### 1. 文件夹结构
每条记录都会创建一个独立的文件夹，文件夹名称为**命名字段的值**：
```
选择的保存目录/
├── 张三/
├── 李四/
└── 王五/
```

### 2. 文档导出规则
每个选中的文本字段都会单独导出为一个文档：

**命名格式**：`姓名_字段名.格式`

示例：
```
张三/
├── 张三_年龄.docx
├── 张三_部门.docx
├── 张三_入职日期.docx
└── 张三_邮箱.docx
```

### 3. 附件导出规则
每个附件都会下载到对应记录的文件夹中：

**命名格式**：`姓名_字段名_原文件名.扩展名`

示例：
```
张三/
├── 张三_简历附件_张三简历.pdf
├── 张三_照片_张三照片.jpg
├── 张三_年龄.docx
└── 张三_部门.docx
```

## 🔧 使用步骤

### 步骤1：选择命名字段
选择用于文件夹命名的字段（通常是姓名或唯一标识符）

### 步骤2：选择导出内容
- **文本字段**：选择需要导出为文档的字段
- **附件字段**：选择需要下载的附件字段

### 步骤3：选择导出格式
- TXT：纯文本格式
- DOCX：Word文档格式  
- PDF：PDF文档格式

### 步骤4：开始导出
1. 点击"开始导出"按钮
2. 选择保存目录（支持文件系统API的浏览器）
3. 等待导出完成

## 📁 最终文件结构示例

```
保存目录/
├── 张三/
│   ├── 张三_年龄.docx           # 文本字段文档
│   ├── 张三_部门.docx
│   ├── 张三_邮箱.docx
│   ├── 张三_简历附件_张三简历.pdf # 附件文件
│   └── 张三_照片_张三照片.jpg
├── 李四/
│   ├── 李四_年龄.docx
│   ├── 李四_部门.docx
│   ├── 李四_邮箱.docx
│   ├── 李四_简历附件_李四简历.docx
│   └── 李四_照片_李四照片.png
└── 王五/
    ├── 王五_年龄.docx
    ├── 王五_部门.docx
    ├── 王五_邮箱.docx
    └── 王五_简历附件_王五简历.pdf
```

## 🌐 浏览器兼容性

### 完整功能支持（可选择文件夹）
- Chrome 86+
- Edge 86+
- Safari 15.2+

### 基础功能支持（传统下载）
- Firefox 90+
- 其他现代浏览器

## ⚠️ 注意事项

1. **文件名清理**：系统会自动清理文件名中的特殊字符
2. **重复文件**：如果存在重复文件名，会自动添加序号
3. **空字段**：空字段会显示为"未命名"
4. **大文件**：大量数据导出可能需要较长时间，请耐心等待
5. **权限问题**：确保浏览器有文件系统访问权限

## 🐛 故障排除

### 常见问题

1. **无法选择文件夹**
   - 检查浏览器是否支持File System Access API
   - 尝试使用Chrome、Edge等支持的浏览器

2. **附件下载失败**
   - 检查网络连接
   - 确认附件链接有效

3. **文件名乱码**
   - 系统会自动处理特殊字符
   - 如有问题请检查原始数据

4. **导出速度慢**
   - 大量数据需要时间处理
   - 可以分批次导出减少单次数据量

## 📞 技术支持

如遇到其他问题，请提供以下信息：
- 浏览器类型和版本
- 错误信息截图
- 操作步骤描述
- 数据规模（记录数、字段数） 