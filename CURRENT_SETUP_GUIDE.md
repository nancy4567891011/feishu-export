# 当前飞书应用设置指南 🔧

基于您当前的配置界面，按以下步骤完成设置：

## 📋 当前状态
✅ 已创建"多维表格导出工具"应用  
✅ 已添加云文档小组件  
✅ 已添加工作台小组件  
✅ 已添加网页应用  
🔄 正在配置各组件参数  

## 🎯 第一步：配置网页应用（最关键）

### 在"网页应用"页面填入：

**桌面端主页：**
```
http://localhost:3000
```

**打开方式选择：**
- ✅ 在飞书内新窗页打开（推荐）
- ❌ 在浏览器中打开

**为什么选择这个？**
- 在飞书内打开可以直接访问多维表格数据
- 具有更好的权限控制
- 用户体验更佳

## 🎯 第二步：配置云文档小组件

### 填写信息：
```
小组件名称：多维表格导出工具
小组件介绍：导出多维表格数据为文档和附件，支持Word、PDF、TXT格式，批量下载附件到本地文件夹
```

### 版本设置：
- 小组件版本：选择最新版本
- 更新类型：自动更新

## 🎯 第三步：配置工作台小组件

### 填写信息：
```
小组件名称：表格导出助手
小组件介绍：快速导出多维表格数据，支持自定义文件命名和文件夹结构
```

## 🎯 第四步：获取应用凭证

### 1. 点击左侧菜单"凭证与基础信息"
### 2. 复制以下信息：
```
App ID: cli_xxxxxxxxxx
App Secret: xxxxxxxxxxxx
```

### 3. 更新本地配置
编辑项目中的 `src/config.ts` 文件：
```typescript
export const config = {
  isDevelopment: false,  // 改为false
  feishu: {
    appId: 'cli_您的App ID',
    appSecret: '您的App Secret',
  }
};
```

## 🎯 第五步：配置权限

### 在"权限管理"中添加：
```
✅ 多维表格权限
  - 读取表格结构
  - 读取表格数据
  - 下载附件

✅ 云文档权限  
  - 创建文档
  - 读写文档

✅ 通用权限
  - 获取用户信息
```

## 🎯 第六步：测试配置

### 1. 保存所有设置

### 2. 在项目中切换到生产模式：
```bash
node switch-mode.js prod
npm run dev
```

### 3. 在飞书中测试：
- 打开任意多维表格
- 查找您的应用入口
- 测试数据读取功能

## ⚠️ 常见问题解决

### 1. 应用找不到
- 确认应用状态为"已发布"或"开发中"
- 检查权限配置是否正确

### 2. 无法访问数据
- 确认网页应用URL配置正确
- 检查本地服务器是否运行在3000端口

### 3. 权限错误
- 在权限管理中确认已授权相关API
- 检查App ID和Secret是否正确

## 📞 下一步行动

完成上述配置后：
1. 您的插件就可以在飞书中使用了
2. 可以读取真实的多维表格数据
3. 可以导出真实的文档和附件

如果配置过程中遇到问题，请告诉我具体的错误信息！ 